<project name="gnubridge" default="run-tests">
	<target name="run-tests">
		<property name="build.dir" value="../temp/publish/gnubridge/" />
		<property name="version" value="0.1.11" />
		<deltree dir="${build.dir}" />
		<mkdir dir="${build.dir}" />
		<copy todir="${build.dir}/src/">
			<fileset dir="./src/">
				<include name="**/*.java" />
			</fileset>
		</copy>
		<copy todir="${build.dir}/test/">
			<fileset dir="./test/">
				<include name="**/*.java" />
			</fileset>
		</copy>
		<copy todir="${build.dir}/acceptance/">
			<fileset dir="./acceptance/">
				<include name="**/*.java" />
			</fileset>
		</copy>

		<copy todir="${build.dir}/resources/">
			<fileset dir="./data/images/cards/jfitz/">
				<include name="**/*.png" />
			</fileset>
		</copy>

		<mkdir dir="${build.dir}/classes/core/" />
		<mkdir dir="${build.dir}/classes/test/" />
		<mkdir dir="${build.dir}/classes/acceptance/" />

		<javac srcdir="${build.dir}/src/" destdir="${build.dir}/classes/core/" debug="on" />
		<javac srcdir="${build.dir}/test/" destdir="${build.dir}/classes/test/" debug="on">
			<classpath>
				<pathelement location="/Applications/eclipse/plugins/org.junit_3.8.2.v20080602-1318/junit.jar" />
				<pathelement location="${build.dir}/classes/core/" />
				<pathelement path="${java.class.path}" />
			</classpath>
		</javac>
		<javac srcdir="${build.dir}/acceptance/" destdir="${build.dir}/classes/acceptance/" debug="on">
			<classpath>
				<pathelement location="/Applications/eclipse/plugins/org.junit_3.8.2.v20080602-1318/junit.jar" />
				<pathelement location="${build.dir}/classes/core/" />
				<pathelement location="${build.dir}/classes/test/" />
				<pathelement path="${java.class.path}" />
			</classpath>
		</javac>

        <mkdir dir="${build.dir}/test/temp/" />
		<junit showoutput="true" printsummary="on" tempdir="${build.dir}/test/temp/">
			<classpath>
				<pathelement location="${build.dir}/classes/core/" />
				<pathelement location="${build.dir}/classes/test/" />
				<pathelement location="${build.dir}/classes/acceptance/" />
				<pathelement location="${build.dir}/resources/" />
				<pathelement path="/Applications/eclipse/plugins/org.junit_3.8.2.v20080602-1318/junit.jar" />
				<pathelement path="${java.class.path}" />
			</classpath>
			<formatter type="plain" />
			<batchtest fork="yes" todir="${build.dir}/test/">
				<fileset dir="${build.dir}/classes/test/">
					<include name="**/*Test.class" />
				</fileset>
				<!--fileset dir="${build.dir}/classes/acceptance/">
					<include name="**/*Test.class" />
				</fileset-->

			</batchtest>

		</junit>
	</target>


	<target name="build-jar">
		<property name="build.dir" value="../temp/publish/gnubridge/" />
		<property name="version" value="0.1.11" />
		<deltree dir="${build.dir}" />
		<mkdir dir="${build.dir}" />

		<copy todir="${build.dir}/src/">
			<fileset dir="./src/">
				<include name="**/*.java" />
			</fileset>
		</copy>

		<copy todir="${build.dir}/resources/">
			<fileset dir="./data/images/cards/jfitz/">
				<include name="**/*.png" />
			</fileset>
		</copy>

		<mkdir dir="${build.dir}/classes/" />

		<javac srcdir="${build.dir}/src/" destdir="${build.dir}/classes/" debug="on" />

		<mkdir dir="${build.dir}/publish/" />
		<jar destfile="${build.dir}/publish/gnubridge-${version}.jar">
			<fileset dir="${build.dir}/classes/" />
			<fileset dir="${build.dir}/resources/" />
			<manifest>
				<attribute name="Main-Class" value="org.gnubridge.presentation.gui.Main" />
			</manifest>
		</jar>

	</target>
</project>